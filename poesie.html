<script>
    document.addEventListener('DOMContentLoaded', function() {
        const hamburger = document.getElementById('hamburger');
        const navMobile = document.querySelector('.nav-mobile');

        hamburger.addEventListener('click', function() {
            navMobile.classList.toggle('active');
        });

        document.querySelectorAll('.nav-mobile a').forEach(link => {
            link.addEventListener('click', () => {
                navMobile.classList.remove('active');
            });
        });

        function createPoesiaElement(nome, poesia) {
            const poesiaItem = document.createElement('div');
            poesiaItem.classList.add('poesia-item');
            poesiaItem.innerHTML = `
                <p><strong>Nome:</strong> ${nome}</p>
                <p><strong>Poesia:</strong> ${poesia}</p>
                <button onclick="deletePoesia('${nome}', '${poesia}')">Elimina</button>
            `;
            return poesiaItem;
        }

        function loadPoesie() {
            fetch('submit_poesia_backend.php')
                .then(response => response.json())
                .then(data => {
                    const poesieList = document.getElementById('poesie-list');
                    poesieList.innerHTML = '';
                    data.forEach(poesia => {
                        poesieList.appendChild(createPoesiaElement(poesia.nome, poesia.poesia));
                    });
                });
        }

        document.getElementById('poesiaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const nome = formData.get('nome');
            const poesia = formData.get('poesia');
            
            fetch('submit_poesia_backend.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const poesieList = document.getElementById('poesie-list');
                    poesieList.prepend(createPoesiaElement(nome, poesia));
                    this.reset();
                }
                alert(data.message);
            });
        });

        window.deletePoesia = function(nome, poesia) {
            const formData = new FormData();
            formData.append('nome', nome);
            formData.append('poesia', poesia);
            formData.append('delete', true);

            fetch('submit_poesia_backend.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    loadPoesie();
                }
                alert(data.message);
            });
        };

        loadPoesie();
    });
</script>
